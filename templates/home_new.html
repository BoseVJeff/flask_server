{% extends 'layout_new.html' %}

{% block page_title %}
Home
{% endblock %}}

{% block main %}
<div class="bg-black h-full text-white">
    {% if not posts or posts==[] %}
    <div class="h-full grid place-items-center">
        No posts made yet :(
    </div>
    {% endif %}
    <div class="h-full flex flex-col gap-4 p-4">
        {% for post in posts %}
        <!--
        // v0 by Vercel.
        // https://v0.dev/t/Jd3OFwX
        -->
        <div class="w-full max-w-xl bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden mx-auto">
            <div class="flex justify-between items-center px-6 py-4">
                <div class="flex space-x-4">
                    <div><img alt="Profile" class="rounded-full" height="48" src="{{post['profile_picture']}}"
                            width="48" style="aspect-ratio:48/48;object-fit:cover"></div>
                    <div>
                        <div class="text-lg font-bold dark:text-white">
                            {{post["username"]}}
                        </div>
                        <div class="text-sm text-gray-500 dark:text-gray-200">
                            {{post["created_at"]}}
                        </div>
                    </div>
                </div>

            </div>
            <div class="px-6 py-4">
                <div class="text-sm text-gray-800 dark:text-gray-200">
                    {{post["content"]}}
                </div>
            </div>
            <div
                class="flex justify-between items-center space-x-4 pt-4 border-t border-gray-200 dark:border-gray-700 p-4">
                <div class="w-full">
                    <form action="/create-post" method="post" class="grid grid-cols=[1fr_auto_.]">
                        <input type="text" name="content" id="content_{{post['id']}}"
                            class="form-input bg-slate-500 col-start-1 col-span-1 rounded-l placeholder:text-neutral-100"
                            placeholder="Reply to {{post['username']}}">
                        <button type="submit" value="Post"
                            class="form-input cursor-pointer w-min bg-blue-500 col-start-2 col-span-1 grid place-items-center rounded-r">
                            <span class="material-symbols-rounded">
                                send
                            </span>
                        </button>
                        {% if post['root_id']==None %}
                        <input type="hidden" name="root_id" value="{{post['id']}}">
                        {% else %}
                        <input type="hidden" name="root_id" value="{{post['root_id']}}">
                        {% endif %}
                        <input type="hidden" name="parent_id" value="{{post['id']}}">
                    </form>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- {% if 'parent_id' in post and post['parent_id']!='None' %} -->
                    <!-- <a href="#{{post['parent_id']}}"> -->
                    <svg class=" h-4 w-4 text-gray-500 dark:text-gray-200" fill="none" height="24" stroke="currentColor"
                        stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" x2="12" y1="3" y2="15"></line>
                    </svg>
                    <!-- </a> -->
                    <!-- {% endif %} -->
                </div>
                <div class="flex items-center space-x-4">
                    <a href="post/{{post['id']}}">
                        <div class="material-symbols-rounded">
                            chat_bubble
                        </div>
                    </a>
                    <!-- <svg class=" h-4 w-4 text-gray-500 dark:text-gray-200" fill="none" height="24" stroke="currentColor"
                        stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"></path>
                    </svg> -->
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block foot %}
<div class="bg-neutral-900 text-white px-4 py-2 dark:shadow">
    <form action="/create-post" method="post" class="grid grid-cols-[1fr_auto]">
        <!-- <input type="text" name="content" id="content" class="col-start-1 col-span-1 form-input bg-slate-500"> -->
        <textarea name="content" id="content"
            class="col-start-1 col-span-1 form-textarea resize-none bg-slate-500 h-12 rounded-l placeholder:text-neutral-100"
            placeholder="{%if root_name %}Reply to {{root_name}} {%else%}Talk to the world{%endif%}"></textarea>
        <input type="submit" value="Post"
            class="col-start-2 col-span-1 form-input bg-blue-500 cursor-pointer rounded-r">
        {% if root_id %}
        <input type="hidden" name="root_id" value="{{root_id}}">
        {% endif %}
        {% if parent_id %}
        <input type="hidden" name="root_id" value="{{parent_id}}">
        <input type="hidden" name="parent_id" value="{{parent_id}}">
        {% endif %}
    </form>
</div>
{% endblock %}